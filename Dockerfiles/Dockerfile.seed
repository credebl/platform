# Stage 1: Build the application
FROM node:18 as build

# Set the working directory
WORKDIR /app

# Copy the rest of the application code
COPY . .

# RUN cd libs/prisma-service && npx prisma migrate deploy && npx prisma generate
RUN cd libs/prisma-service && npx prisma migrate deploy && npx prisma generate

# Set the command to run the microservice
CMD ["sh", "-c", "cd libs/prisma-service && npx prisma migrate deploy && npx prisma generate && npx prisma db seed"]