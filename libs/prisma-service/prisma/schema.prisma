generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model user {
  createDateTime         DateTime                 @default(now()) @db.Timestamptz(6)
  lastChangedDateTime    DateTime                 @default(now()) @db.Timestamptz(6)
  firstName              String?                  @db.VarChar(500)
  lastName               String?                  @db.VarChar(500)
  email                  String?                  @unique(map: "UQ_e12875dfb3b1d92d7d7c5377e22") @db.VarChar(500)
  username               String?                  @db.VarChar(500)
  verificationCode       String?                  @db.VarChar(500)
  isEmailVerified        Boolean                  @default(false)
  supabaseUserId         String?                  @db.VarChar(500)
  clientId               String?                  @db.VarChar(500)
  clientSecret           String?                  @db.VarChar(500)
  profileImg             String?
  fidoUserId             String?                  @db.VarChar(1000)
  isFidoVerified         Boolean                  @default(false)
  publicProfile          Boolean                  @default(false)
  password               String?                  @db.VarChar
  id                     String                   @id(map: "PK_cace4a159ff9f2512dd42373760") @default(uuid()) @db.Uuid
  keycloakUserId         String?                  @db.VarChar(500)
  accounts               account?
  cloud_wallet_user_info cloud_wallet_user_info[]
  ecosystemInvitations   ecosystem_invitations[]
  ecosystemOrgs          ecosystem_orgs[]
  orgInvitations         org_invitations[]
  sessions               session[]
  token                  token[]
  user_activities        user_activity[]
  userDevices            user_devices[]
  userOrgRoles           user_org_roles[]
  user_role_mapping      user_role_mapping[]
}

model account {
  id                String    @id @default(uuid()) @db.Uuid
  userId            String    @unique @db.Uuid
  type              String?
  provider          String
  providerAccountId String
  scope             String?
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
  idToken           String?
  sessionState      String?
  tokenType         String?
  user              user      @relation(fields: [userId], references: [id])
  sessions          session[]
}

model session {
  id           String    @id @default(uuid()) @db.Uuid
  sessionToken String
  userId       String    @db.Uuid
  expires      Int
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  accountId    String?   @db.Uuid
  refreshToken String?
  sessionType  String?
  expiresAt    DateTime? @db.Timestamp(6)
  clientInfo   Json?
  account      account?  @relation(fields: [accountId], references: [id])
  user         user      @relation(fields: [userId], references: [id])
}

model token {
  id        String   @id @default(uuid()) @db.Uuid
  token     String   @unique
  userId    String   @db.Uuid
  createdAt DateTime @default(now())
  expiresAt DateTime
  user      user     @relation(fields: [userId], references: [id])
}

model user_activity {
  action              String
  details             String
  createDateTime      DateTime     @default(now()) @db.Timestamptz(6)
  lastChangedDateTime DateTime     @default(now()) @db.Timestamptz(6)
  deletedAt           DateTime?    @db.Timestamp(6)
  id                  String       @id @default(uuid()) @db.Uuid
  userId              String       @db.Uuid
  orgId               String       @db.Uuid
  createdBy           String       @db.Uuid
  lastChangedBy       String       @db.Uuid
  organisation        organisation @relation(fields: [orgId], references: [id])
  user                user         @relation(fields: [userId], references: [id])
}

model org_roles {
  name                String           @unique
  description         String
  createDateTime      DateTime         @default(now()) @db.Timestamptz(6)
  createdBy           String           @default("1")
  lastChangedDateTime DateTime         @default(now()) @db.Timestamptz(6)
  lastChangedBy       String           @default("1")
  deletedAt           DateTime?        @db.Timestamp(6)
  id                  String           @id @default(uuid()) @db.Uuid
  userOrgRoles        user_org_roles[]
}

model user_org_roles {
  id           String        @id @default(uuid()) @db.Uuid
  userId       String        @db.Uuid
  orgRoleId    String        @db.Uuid
  orgId        String?       @db.Uuid
  idpRoleId    String?       @db.Uuid
  organisation organisation? @relation(fields: [orgId], references: [id])
  orgRole      org_roles     @relation(fields: [orgRoleId], references: [id])
  user         user          @relation(fields: [userId], references: [id])
}

model organisation {
  createDateTime         DateTime                 @default(now()) @db.Timestamptz(6)
  lastChangedDateTime    DateTime                 @default(now()) @db.Timestamptz(6)
  name                   String?                  @db.VarChar(500)
  description            String?                  @db.VarChar(500)
  orgSlug                String?                  @unique
  logoUrl                String?
  website                String?                  @db.VarChar
  publicProfile          Boolean                  @default(false)
  id                     String                   @id @default(uuid()) @db.Uuid
  createdBy              String                   @db.Uuid
  lastChangedBy          String                   @db.Uuid
  clientId               String?                  @db.VarChar(500)
  clientSecret           String?                  @db.VarChar(500)
  idpId                  String?                  @db.VarChar(500)
  registrationNumber     String?                  @db.VarChar(100)
  cityId                 Int?
  countryId              Int?
  stateId                Int?
  appLaunchDetails       Json?
  agent_invitations      agent_invitations[]
  connections            connections[]
  credential_definition  credential_definition[]
  credentials            credentials[]
  ecosystem_invitations  ecosystem_invitations[]
  ecosystemOrgs          ecosystem_orgs[]
  file_upload            file_upload[]
  intent_templates       intent_templates[]
  oid4vc_credentials     oid4vc_credentials[]
  oid4vp_presentations   oid4vp_presentations[]
  org_agents             org_agents?
  orgInvitations         org_invitations[]
  cities                 cities?                  @relation(fields: [cityId], references: [id])
  countries              countries?               @relation(fields: [countryId], references: [id])
  states                 states?                  @relation(fields: [stateId], references: [id])
  presentations          presentations[]
  schema                 schema[]
  user_activities        user_activity[]
  userOrgRoles           user_org_roles[]
  verification_templates verification_templates[]
}

model org_invitations {
  createDateTime      DateTime     @default(now()) @db.Timestamptz(6)
  lastChangedDateTime DateTime     @default(now()) @db.Timestamptz(6)
  deletedAt           DateTime?    @db.Timestamp(6)
  status              String
  orgRoles            String[]
  email               String?
  id                  String       @id @default(uuid()) @db.Uuid
  userId              String       @db.Uuid
  orgId               String       @db.Uuid
  createdBy           String       @db.Uuid
  lastChangedBy       String       @db.Uuid
  organisation        organisation @relation(fields: [orgId], references: [id])
  user                user         @relation(fields: [userId], references: [id])
}

model user_devices {
  createDateTime      DateTime  @default(now()) @db.Timestamptz(6)
  lastChangedDateTime DateTime  @default(now()) @db.Timestamptz(6)
  devices             Json?     @default("[]")
  credentialId        String?   @unique(map: "UQ_7c903f5e362fe8fd3d3edba17b5") @db.VarChar
  deviceFriendlyName  String?   @db.VarChar
  deletedAt           DateTime? @db.Timestamp(6)
  authCounter         Int       @default(0)
  id                  String    @id(map: "PK_c9e7e648903a9e537347aba4371") @default(uuid()) @db.Uuid
  userId              String?   @db.Uuid
  createdBy           String    @db.Uuid
  lastChangedBy       String    @db.Uuid
  user                user?     @relation(fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_e12ac4f8016243ac71fd2e415af")
}

model platform_config {
  externalIp          String    @db.VarChar
  username            String    @db.VarChar
  sgApiKey            String    @db.VarChar
  emailFrom           String    @db.VarChar
  apiEndpoint         String    @db.VarChar
  tailsFileServer     String    @db.VarChar
  createDateTime      DateTime  @default(now()) @db.Timestamptz(6)
  createdBy           String    @default("1")
  lastChangedDateTime DateTime  @default(now()) @db.Timestamptz(6)
  lastChangedBy       String    @default("1")
  deletedAt           DateTime? @db.Timestamp(6)
  id                  String    @id @default(uuid()) @db.Uuid
  inboundEndpoint     String?   @db.VarChar
  isEcosystemEnabled  Boolean   @default(false)
}

model org_agents {
  createDateTime      DateTime            @default(now()) @db.Timestamptz(6)
  lastChangedDateTime DateTime            @default(now()) @db.Timestamptz(6)
  orgDid              String?             @db.VarChar
  verkey              String?             @db.VarChar
  agentEndPoint       String?             @db.VarChar
  isDidPublic         Boolean?
  agentSpinUpStatus   Int?
  agentOptions        Bytes?
  walletName          String?             @db.VarChar
  tenantId            String?
  apiKey              String?
  id                  String              @id @default(uuid()) @db.Uuid
  agentId             String?             @db.Uuid
  agentsTypeId        String?             @db.Uuid
  orgId               String?             @unique @db.Uuid
  orgAgentTypeId      String?             @db.Uuid
  ledgerId            String?             @db.Uuid
  createdBy           String              @db.Uuid
  lastChangedBy       String              @db.Uuid
  webhookUrl          String?             @db.VarChar
  didDocument         Json?
  agent_invitations   agent_invitations[]
  oid4vp_verifiers    oid4vp_verifier[]
  oidc_issuer         oidc_issuer[]
  agents              agents?             @relation(fields: [agentId], references: [id])
  agents_type         agents_type?        @relation(fields: [agentsTypeId], references: [id])
  ledgers             ledgers?            @relation(fields: [ledgerId], references: [id])
  org_agent_type      org_agents_type?    @relation(fields: [orgAgentTypeId], references: [id])
  organisation        organisation?       @relation(fields: [orgId], references: [id])
  org_dids            org_dids[]
  x509_certificates   x509_certificates[]
}

model org_dids {
  id                  String     @id @default(uuid()) @db.Uuid
  createDateTime      DateTime   @default(now()) @db.Timestamptz(6)
  createdBy           String     @db.Uuid
  lastChangedDateTime DateTime   @default(now()) @db.Timestamptz(6)
  lastChangedBy       String     @db.Uuid
  orgId               String     @db.Uuid
  did                 String     @db.VarChar(500)
  didDocument         Json
  orgAgentId          String     @db.Uuid
  isPrimaryDid        Boolean
  org_agents          org_agents @relation(fields: [orgAgentId], references: [id])
}

model org_agents_type {
  createDateTime      DateTime     @default(now()) @db.Timestamptz(6)
  lastChangedDateTime DateTime     @default(now()) @db.Timestamptz(6)
  agent               String       @db.VarChar(500)
  id                  String       @id @default(uuid()) @db.Uuid
  org_agents          org_agents[]
}

model agents_type {
  createDateTime      DateTime     @default(now()) @db.Timestamptz(6)
  lastChangedDateTime DateTime     @default(now()) @db.Timestamptz(6)
  agent               String       @db.VarChar(500)
  id                  String       @id @default(uuid()) @db.Uuid
  org_agents          org_agents[]
}

model ledgers {
  createDateTime      DateTime     @default(now()) @db.Timestamptz(6)
  lastChangedDateTime DateTime     @default(now()) @db.Timestamptz(6)
  name                String       @db.VarChar
  networkType         String       @db.VarChar
  poolConfig          String       @db.VarChar
  isActive            Boolean
  networkString       String       @db.VarChar
  nymTxnEndpoint      String       @db.VarChar
  indyNamespace       String?      @db.VarChar
  id                  String       @id @default(uuid()) @db.Uuid
  networkUrl          String?      @db.VarChar
  org_agents          org_agents[]
  schema              schema[]
}

model agents {
  createDateTime      DateTime     @default(now()) @db.Timestamptz(6)
  lastChangedDateTime DateTime     @default(now()) @db.Timestamptz(6)
  name                String
  id                  String       @id @default(uuid()) @db.Uuid
  org_agents          org_agents[]
}

model schema {
  createDateTime        DateTime                @default(now()) @db.Timestamptz(6)
  lastChangedDateTime   DateTime                @default(now()) @db.Timestamptz(6)
  name                  String                  @db.VarChar
  version               String                  @db.VarChar
  attributes            String
  schemaLedgerId        String                  @db.VarChar
  publisherDid          String                  @db.VarChar
  issuerId              String                  @db.VarChar
  id                    String                  @id(map: "PK_c9e7e648903a9e537347aba4372") @default(uuid()) @db.Uuid
  orgId                 String?                 @db.Uuid
  createdBy             String                  @db.Uuid
  lastChangedBy         String                  @db.Uuid
  ledgerId              String?                 @db.Uuid
  type                  String?                 @db.VarChar
  isSchemaArchived      Boolean                 @default(false)
  alias                 String?
  credential_definition credential_definition[]
  ledgers               ledgers?                @relation(fields: [ledgerId], references: [id])
  organisation          organisation?           @relation(fields: [orgId], references: [id])
}

model credential_definition {
  createDateTime         DateTime      @default(now()) @db.Timestamptz(6)
  lastChangedDateTime    DateTime      @default(now()) @db.Timestamptz(6)
  credentialDefinitionId String        @db.VarChar
  tag                    String        @db.VarChar
  schemaLedgerId         String        @db.VarChar
  revocable              Boolean       @default(false)
  id                     String        @id(map: "PK_c9e7e648903a9e537347aba4373") @default(uuid()) @db.Uuid
  createdBy              String        @db.Uuid
  lastChangedBy          String        @db.Uuid
  schemaId               String        @db.Uuid
  orgId                  String?       @db.Uuid
  organisation           organisation? @relation(fields: [orgId], references: [id])
  schema                 schema        @relation(fields: [schemaId], references: [id])
}

model shortening_url {
  referenceId         String?   @unique @db.VarChar(50)
  type                String?   @db.VarChar
  id                  String    @id @default(uuid()) @db.Uuid
  createDateTime      DateTime  @default(now()) @db.Timestamptz(6)
  deletedAt           DateTime? @db.Timestamp(6)
  invitationPayload   Json?
  lastChangedDateTime DateTime  @default(now()) @db.Timestamptz(6)
}

model agent_invitations {
  connectionInvitation String
  multiUse             Boolean
  createDateTime       DateTime     @default(now()) @db.Timestamptz(6)
  createdBy            Int          @default(1)
  lastChangedDateTime  DateTime     @default(now()) @db.Timestamptz(6)
  lastChangedBy        Int          @default(1)
  id                   String       @id @default(uuid()) @db.Uuid
  agentId              String       @db.Uuid
  orgId                String       @db.Uuid
  recipientKey         String?
  invitationDid        String?
  org_agents           org_agents   @relation(fields: [agentId], references: [id])
  organisation         organisation @relation(fields: [orgId], references: [id])
}

model connections {
  createDateTime      DateTime        @default(now()) @db.Timestamptz(6)
  lastChangedDateTime DateTime        @default(now()) @db.Timestamptz(6)
  connectionId        String          @unique
  state               String
  id                  String          @id @default(uuid()) @db.Uuid
  orgId               String?         @db.Uuid
  createdBy           String          @db.Uuid
  lastChangedBy       String          @db.Uuid
  theirLabel          String          @default("")
  organisation        organisation?   @relation(fields: [orgId], references: [id])
  credentials         credentials[]
  presentations       presentations[]
}

model credentials {
  createDateTime       DateTime      @default(now()) @db.Timestamptz(6)
  lastChangedDateTime  DateTime      @default(now()) @db.Timestamptz(6)
  connectionId         String?
  threadId             String        @unique
  id                   String        @id @default(uuid()) @db.Uuid
  orgId                String?       @db.Uuid
  createdBy            String        @db.Uuid
  lastChangedBy        String        @db.Uuid
  credentialExchangeId String        @default("")
  state                String        @default("")
  schemaId             String        @default("")
  credDefId            String        @default("")
  connections          connections?  @relation(fields: [connectionId], references: [connectionId])
  organisation         organisation? @relation(fields: [orgId], references: [id])
}

model presentations {
  createDateTime      DateTime      @default(now()) @db.Timestamptz(6)
  lastChangedDateTime DateTime      @default(now()) @db.Timestamptz(6)
  connectionId        String?
  state               String?
  threadId            String        @unique
  isVerified          Boolean?
  id                  String        @id @default(uuid()) @db.Uuid
  orgId               String?       @db.Uuid
  createdBy           String        @db.Uuid
  lastChangedBy       String        @db.Uuid
  presentationId      String?
  schemaId            String?       @db.VarChar
  emailId             String?
  errorMessage        String?       @db.VarChar
  connections         connections?  @relation(fields: [connectionId], references: [connectionId])
  organisation        organisation? @relation(fields: [orgId], references: [id])
}

model file_upload {
  name                String?
  status              String?
  upload_type         String?
  createDateTime      DateTime      @default(now()) @db.Timestamptz(6)
  lastChangedDateTime DateTime      @default(now()) @db.Timestamptz(6)
  deletedAt           DateTime?     @db.Timestamp(6)
  id                  String        @id @default(uuid()) @db.Uuid
  orgId               String?       @db.Uuid
  createdBy           String        @db.Uuid
  lastChangedBy       String        @db.Uuid
  credential_type     String?
  templateId          String?       @db.VarChar
  file_data           file_data[]
  organisation        organisation? @relation(fields: [orgId], references: [id])
}

model file_data {
  referenceId         String?
  error               String?
  detailError         String?
  createDateTime      DateTime    @default(now()) @db.Timestamptz(6)
  lastChangedDateTime DateTime    @default(now()) @db.Timestamptz(6)
  deletedAt           DateTime?   @db.Timestamp(6)
  isError             Boolean?
  credDefId           String?
  schemaId            String?
  status              Boolean     @default(false)
  credential_data     Json?
  id                  String      @id @default(uuid()) @db.Uuid
  fileUploadId        String      @db.Uuid
  createdBy           String      @db.Uuid
  lastChangedBy       String      @db.Uuid
  credential_type     String?
  fileUpload          file_upload @relation(fields: [fileUploadId], references: [id])
}

model notification {
  id                  String    @id @default(uuid()) @db.Uuid
  orgId               String?   @unique @db.Uuid
  notificationWebhook String?
  createDateTime      DateTime  @default(now()) @db.Timestamptz(6)
  createdBy           String    @default("1")
  lastChangedDateTime DateTime  @default(now()) @db.Timestamptz(6)
  lastChangedBy       String    @default("1")
  deletedAt           DateTime? @db.Timestamp(6)
}

model ledgerConfig {
  id                  String    @id @default(uuid()) @db.Uuid
  name                String
  details             Json
  createDateTime      DateTime  @default(now()) @db.Timestamptz(6)
  createdBy           String    @default("1")
  lastChangedDateTime DateTime  @default(now()) @db.Timestamptz(6)
  lastChangedBy       String    @default("1")
  deletedAt           DateTime? @db.Timestamp(6)
}

model user_org_delete_activity {
  id             String     @id @default(uuid()) @db.Uuid
  userId         String     @db.Uuid
  orgId          String     @db.Uuid
  recordType     RecordType
  txnMetadata    Json
  deletedBy      String     @db.Uuid
  deleteDateTime DateTime   @default(now()) @db.Timestamptz(6)
  userEmail      String     @default("")
}

model countries {
  id           Int            @id @default(autoincrement()) @map("id")
  name         String         @map("name")
  cities       cities[]
  organisation organisation[]
  states       states[]

  @@map("countries")
}

model states {
  id           Int            @id @default(autoincrement()) @map("id")
  name         String         @map("name")
  countryId    Int            @map("country_id")
  countryCode  String         @map("country_code")
  cities       cities[]
  organisation organisation[]
  countries    countries      @relation(fields: [countryId], references: [id], onDelete: Cascade)

  @@map("states")
}

model cities {
  id           Int            @id @default(autoincrement()) @map("id")
  name         String         @map("name")
  stateId      Int            @map("state_id")
  stateCode    String         @map("state_code")
  countryId    Int            @map("country_id")
  countryCode  String         @map("country_code")
  country      countries      @relation(fields: [countryId], references: [id], onDelete: Cascade)
  state        states         @relation(fields: [stateId], references: [id], onDelete: Cascade)
  organisation organisation[]

  @@index([stateId], map: "cities_stateId_idx")
  @@index([countryId], map: "cities_countryId_idx")
  @@map("cities")
}

model user_role {
  id                String              @id @default(uuid()) @db.Uuid
  role              UserRole
  user_role_mapping user_role_mapping[]
}

model user_role_mapping {
  id         String    @id @default(uuid()) @db.Uuid
  userId     String    @db.Uuid
  userRoleId String    @db.Uuid
  user       user      @relation(fields: [userId], references: [id])
  user_role  user_role @relation(fields: [userRoleId], references: [id])
}

model cloud_wallet_user_info {
  id                  String          @id @default(uuid()) @db.Uuid
  label               String?
  tenantId            String?
  email               String?         @unique @db.VarChar(500)
  type                CloudWalletType
  createDateTime      DateTime        @default(now()) @db.Timestamptz(6)
  createdBy           String          @db.Uuid
  lastChangedDateTime DateTime        @default(now()) @db.Timestamptz(6)
  lastChangedBy       String          @db.Uuid
  userId              String?         @db.Uuid
  agentApiKey         String?
  agentEndpoint       String?
  key                 String?
  connectionImageUrl  String?
  user                user?           @relation(fields: [userId], references: [id])
}

model client_aliases {
  id                  String   @id @default(uuid()) @db.Uuid
  createDateTime      DateTime @default(now()) @db.Timestamptz(6)
  lastChangedDateTime DateTime @default(now()) @db.Timestamptz(6)
  clientAlias         String?
  clientUrl           String
}

model oidc_issuer {
  id                          String                 @id @default(uuid()) @db.Uuid
  createDateTime              DateTime               @default(now()) @db.Timestamptz(6)
  createdBy                   String                 @db.Uuid
  metadata                    Json
  orgAgentId                  String                 @db.Uuid
  publicIssuerId              String
  batchCredentialIssuanceSize Int                    @default(0)
  authorizationServerUrl      String
  templates                   credential_templates[]
  orgAgent                    org_agents             @relation(fields: [orgAgentId], references: [id])

  @@index([orgAgentId])
}

model oid4vc_credentials {
  id                         String       @id @default(uuid()) @db.Uuid
  orgId                      String       @db.Uuid
  credentialOfferId          String
  state                      String
  contextCorrelationId       String
  createdBy                  String       @db.Uuid
  createDateTime             DateTime     @default(now()) @db.Timestamptz(6)
  lastChangedDateTime        DateTime     @default(now()) @db.Timestamptz(6)
  lastChangedBy              String       @db.Uuid
  credentialConfigurationIds String[]
  issuanceSessionId          String       @unique
  issuedCredentials          String[]
  publicIssuerId             String
  organisation               organisation @relation(fields: [orgId], references: [id])

  @@index([credentialConfigurationIds], type: Gin)
}

model oid4vp_presentations {
  id                    String       @id @default(uuid()) @db.Uuid
  orgId                 String       @db.Uuid
  verificationSessionId String       @unique
  presentationId        String
  state                 String
  contextCorrelationId  String
  createdBy             String       @db.Uuid
  createDateTime        DateTime     @default(now()) @db.Timestamptz(6)
  lastChangedDateTime   DateTime     @default(now()) @db.Timestamptz(6)
  lastChangedBy         String       @db.Uuid
  publicVerifierId      String
  organisation          organisation @relation(fields: [orgId], references: [id])
}

model credential_templates {
  id           String       @id @default(uuid())
  name         String
  description  String?
  format       String
  canBeRevoked Boolean      @default(false)
  attributes   Json
  appearance   Json
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
  issuerId     String       @db.Uuid
  signerOption SignerOption
  issuer       oidc_issuer  @relation(fields: [issuerId], references: [id])
}

model x509_certificates {
  id                  String     @id @default(uuid())
  orgAgentId          String     @db.Uuid
  keyType             String
  status              String
  validFrom           DateTime
  expiry              DateTime
  certificateBase64   String
  isImported          Boolean    @default(false)
  createdAt           DateTime   @default(now())
  createdBy           String     @db.Uuid
  lastChangedDateTime DateTime   @updatedAt
  lastChangedBy       String     @db.Uuid
  keyId               String?
  org_agents          org_agents @relation(fields: [orgAgentId], references: [id])
}

model oid4vp_verifier {
  id                  String     @id @default(uuid()) @db.Uuid
  publicVerifierId    String
  metadata            Json
  verifierId          String     @unique
  createDateTime      DateTime   @default(now()) @db.Timestamptz(6)
  createdBy           String     @default("1")
  lastChangedDateTime DateTime   @default(now()) @db.Timestamptz(6)
  lastChangedBy       String     @default("1")
  orgAgentId          String     @db.Uuid
  orgAgent            org_agents @relation(fields: [orgAgentId], references: [id])

  @@index([orgAgentId])
}

model verification_templates {
  id                  String             @id @default(uuid()) @db.Uuid
  name                String             @db.VarChar(500)
  templateJson        Json
  orgId               String             @db.Uuid
  createDateTime      DateTime           @default(now()) @db.Timestamptz(6)
  createdBy           String             @db.Uuid
  lastChangedDateTime DateTime           @default(now()) @db.Timestamptz(6)
  lastChangedBy       String             @db.Uuid
  signerOption        SignerOption
  intentTemplates     intent_templates[]
  organisation        organisation       @relation(fields: [orgId], references: [id])

  @@index([orgId])
}

model intents {
  id                  String             @id @default(uuid()) @db.Uuid
  name                String             @db.VarChar(500)
  description         String?
  createDateTime      DateTime           @default(now()) @db.Timestamptz(6)
  createdBy           String             @db.Uuid
  lastChangedDateTime DateTime           @default(now()) @db.Timestamptz(6)
  lastChangedBy       String             @db.Uuid
  ecosystemId         String             @db.Uuid
  intentTemplates     intent_templates[]
  ecosystem           ecosystem          @relation(fields: [ecosystemId], references: [id])
}

model intent_templates {
  id                  String                 @id @default(uuid()) @db.Uuid
  orgId               String?                @db.Uuid
  intentId            String                 @db.Uuid
  templateId          String                 @db.Uuid
  createDateTime      DateTime               @default(now()) @db.Timestamptz(6)
  createdBy           String                 @db.Uuid
  lastChangedDateTime DateTime               @default(now()) @db.Timestamptz(6)
  lastChangedBy       String                 @db.Uuid
  intent              intents                @relation(fields: [intentId], references: [id])
  organisation        organisation?          @relation(fields: [orgId], references: [id])
  template            verification_templates @relation(fields: [templateId], references: [id])

  @@index([orgId])
  @@index([intentId])
  @@index([templateId])
}

model ecosystem {
  id                   String                  @id @default(uuid()) @db.Uuid
  name                 String
  description          String
  tags                 String?
  createDateTime       DateTime                @default(now()) @db.Timestamptz(6)
  createdBy            String                  @db.Uuid
  lastChangedDateTime  DateTime                @default(now()) @db.Timestamptz(6)
  lastChangedBy        String                  @db.Uuid
  deletedAt            DateTime?               @db.Timestamp(6)
  logoUrl              String?
  autoEndorsement      Boolean                 @default(false)
  ledgers              Json?
  ecosystemInvitations ecosystem_invitations[]
  ecosystemOrgs        ecosystem_orgs[]
  intent               intents[]
}

model ecosystem_roles {
  id                  String           @id @default(uuid()) @db.Uuid
  name                String           @unique
  description         String
  createDateTime      DateTime         @default(now()) @db.Timestamptz(6)
  lastChangedDateTime DateTime         @default(now()) @db.Timestamptz(6)
  deletedAt           DateTime?        @db.Timestamp(6)
  ecosystemOrgs       ecosystem_orgs[]
}

model ecosystem_orgs {
  id                  String          @id @default(uuid()) @db.Uuid
  orgId               String          @db.Uuid
  status              String
  deploymentMode      String?
  ecosystemId         String          @db.Uuid
  ecosystemRoleId     String          @db.Uuid
  createDateTime      DateTime        @default(now()) @db.Timestamptz(6)
  createdBy           String          @db.Uuid
  lastChangedDateTime DateTime        @default(now()) @db.Timestamptz(6)
  lastChangedBy       String          @db.Uuid
  deletedAt           DateTime?       @db.Timestamp(6)
  userId              String          @db.Uuid
  ecosystem           ecosystem       @relation(fields: [ecosystemId], references: [id])
  ecosystemRole       ecosystem_roles @relation(fields: [ecosystemRoleId], references: [id])
  organisation        organisation    @relation(fields: [orgId], references: [id])
  user                user            @relation(fields: [userId], references: [id])

  @@unique([orgId, ecosystemId])
}

model ecosystem_invitations {
  id                  String        @id @default(uuid()) @db.Uuid
  email               String
  status              String
  userId              String?       @db.Uuid
  type                String
  ecosystemId         String?       @db.Uuid
  invitedOrg          String?       @db.Uuid
  createDateTime      DateTime      @default(now()) @db.Timestamptz(6)
  createdBy           String        @db.Uuid
  lastChangedDateTime DateTime      @default(now()) @db.Timestamptz(6)
  lastChangedBy       String        @db.Uuid
  deletedAt           DateTime?     @db.Timestamp(6)
  ecosystem           ecosystem?    @relation(fields: [ecosystemId], references: [id])
  organisation        organisation? @relation(fields: [invitedOrg], references: [id])
  user                user?         @relation(fields: [userId], references: [id])

  @@unique([email, ecosystemId, invitedOrg])
}

model holder_notification {
  id                  String    @id @default(uuid()) @db.Uuid
  sessionId           String    @unique
  holderDid           String
  fcmToken            String
  state               String
  createDateTime      DateTime  @default(now()) @db.Timestamptz(6)
  lastChangedDateTime DateTime  @default(now()) @db.Timestamptz(6)
  deletedAt           DateTime? @db.Timestamp(6)
}

enum RecordType {
  VERIFICATION_RECORD
  ISSUANCE_RECORD
  CONNECTION
  ECOSYSTEM_MEMBER
  ORGANIZATION
  WALLET
  INVITATION
}

enum UserRole {
  DEFAULT_USER
  HOLDER
}

enum CloudWalletType {
  CLOUD_BASE_WALLET
  CLOUD_SUB_WALLET
}

enum SignerOption {
  DID
  X509_P256
  X509_ED25519
}
